<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>System Configuration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="$relpath/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="$relpath/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<table><tr><td><img class="header" src="LEGO.jpg"></td><td><h1>&nbsp;&nbsp;&nbsp;LEGO Mindstorms EV3</h1></td></tr></table><hr size="1"/>
<!-- Generated by Doxygen 1.8.7 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Firmware Documentation</a></li><li class="navelem"><a class="el" href="implementation.html">Implementation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">System Configuration </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr/>
<p>Following defines sets the system configuration and limitations.<br />
 Defines with preceding "vm" is visible for the byte code assembler<br />
 </p><pre class="fragment"> */

#define   PROJECT                       "LMS2012"
#define   VERS                          1.09

//#define   RETAILVERS                                  //!&lt; Retail version
//#define   EDUCATIONVERS                               //!&lt; Education version
#define   DEVELOPERVERS                               //!&lt; Developer version (telnet with password)
//#define   TESTVERS                      '1'           //!&lt; Minor version (not shown if less than ASCII zero)


#ifdef RETAILVERS

#define   SPECIALVERS                   'H'
#define   LEGO_BUNDLE_SEED_ID           "9RNK8ZF528"
#define   LEGO_BUNDLE_ID                "com.lego.lms"

#endif

#ifdef EDUCATIONVERS

#define   SPECIALVERS                   'E'
#define   LEGO_BUNDLE_SEED_ID           "9YZJD9MXPZ"
#define   LEGO_BUNDLE_ID                "com.lego.education.ev3"

#endif

#ifdef DEVELOPERVERS

#define   SPECIALVERS                   'D'
#define   LEGO_BUNDLE_SEED_ID           "9RNK8ZF528"
#define   LEGO_BUNDLE_ID                "com.lego.lms"

#endif

#ifdef TESTVERS

#define   SPECIALVERS                   TESTVERS
#define   LEGO_BUNDLE_SEED_ID           "BA9Q76VTQG"
#define   LEGO_BUNDLE_ID                "com.lego.education.ev3"
/*
#define   SPECIALVERS                   TESTVERS
#define   LEGO_BUNDLE_SEED_ID           "BA9Q76VTQG"
#define   LEGO_BUNDLE_ID                "com.lego.edu.ev3"

#define   SPECIALVERS                   TESTVERS
#define   LEGO_BUNDLE_SEED_ID           "BA9Q76VTQG"
#define   LEGO_BUNDLE_ID                "com.lego.education.ev3programming"
*/
#endif


#define   MAX_PROGRAMS          SLOTS                 //!&lt; Max number of programs (including UI and direct commands) running at a time
#define   MAX_BREAKPOINTS       4                     //!&lt; Max number of breakpoints (opCODES depends on this value)
#define   MAX_LABELS            32                    //!&lt; Max number of labels per program
#define   MAX_DEVICE_TYPE       127                   //!&lt; Highest type number (positive)
#define   MAX_VALID_TYPE        vmMAX_VALID_TYPE      //!&lt; Highest valid type
#define   MAX_DEVICE_MODES      8                     //!&lt; Max number of modes in one device
#define   MAX_DEVICE_DATASETS   8                     //!&lt; Max number of data sets in one device
#define   MAX_DEVICE_DATALENGTH 32                    //!&lt; Max device data length

#define   MAX_DEVICE_BUSY_TIME  1200                  //!&lt; Max number of mS a device can be busy when read

#define   MAX_DEVICE_TYPES      ((MAX_DEVICE_TYPE + 1) * MAX_DEVICE_MODES)//!&lt; Max number of different device types and modes (max type data list size)

#define   MAX_FRAMES_PER_SEC    10                    //!&lt; Max frames per second update in display

#define   CACHE_DEEPT           10                    //!&lt; Max number of programs cached (in RECENT FILES MENU)
#define   MAX_HANDLES           500                   //!&lt; Max number of handles to memory pools and arrays in one program

#define   MAX_ARRAY_SIZE        1000000000            //!&lt; Max array size
#define   MIN_ARRAY_ELEMENTS    0                     //!&lt; Min elements in a DATA8 array

#define   INSTALLED_MEMORY      6000                  //!&lt; Flash allocated to hold user programs/data
#define   LOW_MEMORY            500                   //!&lt; Low memory warning [KB]

#define   LOGBUFFER_SIZE        1000                  //!&lt; Min log buffer size
#define   DEVICE_LOGBUF_SIZE    300                   //!&lt; Device log buffer size (black layer buffer)
#define   MIN_LIVE_UPDATE_TIME  10                    //!&lt; [mS] Min sample time when live update

#define   MIN_IIC_REPEAT_TIME   10                    //!&lt; [mS] Min IIC device repeat time
#define   MAX_IIC_REPEAT_TIME   1000                  //!&lt; [mS] Max IIC device repeat time

#define   MAX_COMMAND_BYTECODES 64                    //!&lt; Max number of byte codes in a debug terminal direct command
#define   MAX_COMMAND_LOCALS    64                    //!&lt; Max number of bytes allocated for direct command local variables
#define   MAX_COMMAND_GLOBALS   1021                  //!&lt; Max number of bytes allocated for direct command global variables

#define   UI_PRIORITY           20                    //!&lt; UI byte codes before switching VM thread
#define   C_PRIORITY            200                   //!&lt; C call byte codes

#ifndef DISABLE_PREEMPTED_VM
#define   PRG_PRIORITY          2000                  //!&lt; Prg byte codes before switching VM thread
#else
#define   PRG_PRIORITY          200                   //!&lt; Prg byte codes before switching VM thread
#endif

#define   BUTTON_DEBOUNCE_TIME        30
#define   BUTTON_START_REPEAT_TIME    400
#define   BUTTON_REPEAT_TIME          200

#define   LONG_PRESS_TIME       3000                  //!&lt; [mS] Time pressed before long press recognised

#define   ADC_REF               5000                  //!&lt; [mV]  maximal value on ADC
#define   ADC_RES               4095                  //!&lt; [CNT] maximal count on ADC

#define   IN1_ID_HYSTERESIS     50                    //!&lt; [mV]  half of the span one Id takes up on input connection 1 voltage
#define   OUT5_ID_HYSTERESIS    100                   //!&lt; [mV]  half of the span one Id takes up on output connection 5 voltage

#define   DEVICE_UPDATE_TIME    1000000               //!&lt; Min device (sensor) update time [nS]
#define   DELAY_TO_TYPEDATA     10000                 //!&lt; Time from daisy chain active to upload type data [mS]
#define   DAISYCHAIN_MODE_TIME  10                    //!&lt; Time for daisy chain change mode [mS]
#define   MAX_FILE_HANDLES      64                    //!&lt; Max number of down load file handles
#define   MIN_HANDLE            3                     //!&lt; Min file handle to close

#define   ID_LENGTH             7                     //!&lt; Id length  (BT MAC id) (incl. zero terminator)
#define   NAME_LENGTH           12                    //!&lt; Name length (not including zero termination)

#define   ERROR_BUFFER_SIZE     8                     //!&lt; Number of errors in buffer

#define   PWM_DEVICE            "lms_pwm"             //!&lt; PWM device name
#define   PWM_DEVICE_NAME       "/dev/lms_pwm"        //!&lt; PWM device file name

#define   MOTOR_DEVICE          "lms_motor"           //!&lt; TACHO device name
#define   MOTOR_DEVICE_NAME     "/dev/lms_motor"      //!&lt; TACHO device file name

#define   ANALOG_DEVICE         "lms_analog"          //!&lt; ANALOG device name
#define   ANALOG_DEVICE_NAME    "/dev/lms_analog"     //!&lt; ANALOG device file name

#define   POWER_DEVICE          "lms_power"           //!&lt; POWER device name
#define   POWER_DEVICE_NAME     "/dev/lms_power"      //!&lt; POWER device file name

#define   DCM_DEVICE            "lms_dcm"             //!&lt; DCM device name
#define   DCM_DEVICE_NAME       "/dev/lms_dcm"        //!&lt; DCM device file name

#define   UI_DEVICE             "lms_ui"              //!&lt; UI device name
#define   UI_DEVICE_NAME        "/dev/lms_ui"         //!&lt; UI device file name

#define   LCD_DEVICE            "lms_display"         //!&lt; DISPLAY device name
//#define   LCD_DEVICE_NAME       "/dev/lms_display"    //!&lt; DISPLAY device file name
#define   LCD_DEVICE_NAME       "/dev/fb0"            //!&lt; DISPLAY device file name

#define   UART_DEVICE           "lms_uart"            //!&lt; UART device name
#define   UART_DEVICE_NAME      "/dev/lms_uart"       //!&lt; UART device file name

#define   USBDEV_DEVICE         "lms_usbdev"          //!&lt; USB device
#define   USBDEV_DEVICE_NAME    "/dev/lms_usbdev"     //!&lt; USB device

#define   USBHOST_DEVICE        "lms_usbhost"         //!&lt; USB host
#define   USBHOST_DEVICE_NAME   "/dev/lms_usbhost"    //!&lt; USB host

#define   SOUND_DEVICE          "lms_sound"           //!&lt; SOUND device name
#define   SOUND_DEVICE_NAME     "/dev/lms_sound"      //!&lt; SOUND device

#define   IIC_DEVICE            "lms_iic"             //!&lt; IIC device name
#define   IIC_DEVICE_NAME       "/dev/lms_iic"        //!&lt; IIC device

#define   BT_DEVICE             "lms_bt"              //!&lt; BT device name
#define   BT_DEVICE_NAME        "/dev/lms_bt"         //!&lt; BT device

#define   UPDATE_DEVICE          "lms_update"         //!&lt; UPDATE device name
#define   UPDATE_DEVICE_NAME     "/dev/lms_update"    //!&lt; UPDATE device

#define   TEST_PIN_DEVICE       "lms_tst_pin"         //!&lt; TEST pin device name
#define   TEST_PIN_DEVICE_NAME  "/dev/lms_tst_pin"    //!&lt; TEST pin device file name

#define   TEST_UART_DEVICE      "lms_tst_uart"        //!&lt; TEST UART device name
#define   TEST_UART_DEVICE_NAME "/dev/lms_tst_uart"   //!&lt; TEST UART device file name


#define   DIR_DEEPT             vmDIR_DEEPT           //!&lt; Max directory items allocated

// File

//***********************************************************************************************************************
//! \todo Filename sizes should only use vmPATHSIZE, vmNAMESIZE, vmEXTSIZE and vmFILENAMESIZE

#define   FILENAMESIZE          vmFILENAMESIZE        //!&lt; All inclusive (path, filename, extension and zero termination)
#define   FILENAME_SIZE         52                    //!&lt; User filename size without extension including zero
#define   FOLDERNAME_SIZE       10                    //!&lt; Folder name size relative to "lms2012" folder including zero
#define   SUBFOLDERNAME_SIZE    FILENAME_SIZE         //!&lt; Sub folder name size without "/" including zero

#define   MAX_FILENAME_SIZE     (FOLDERNAME_SIZE + SUBFOLDERNAME_SIZE + FILENAME_SIZE + 5)

//***********************************************************************************************************************

#define   TYPEDATE_FILE_NAME    "typedata"            //!&lt; TypeData filename
#define   ICON_FILE_NAME        "icon"                //!&lt; Icon image filename
#define   TEXT_FILE_NAME        "text"                //!&lt; Text filename

#define   DEMO_FILE_NAME        "../prjs/BrkProg_SAVE/Demo.rpf"

// Memory





// SD card

#ifdef Linux_X86
#define   SDCARD_DEVICE1        "/dev/mmcblk0"
#define   SDCARD_DEVICE2        "/dev/mmcblk0p1"
#else
#define   SDCARD_DEVICE1        "/dev/mmcblk0"
#define   SDCARD_DEVICE2        "/dev/mmcblk0p1"
#endif

#define   SDCARD_MOUNT          "./mount_sdcard"
#define   SDCARD_UNMOUNT        "./unmount_sdcard"

// USB stick

#ifndef Linux_X86
#define   USBSTICK_DEVICE       "/dev/sda"
#else
#define   USBSTICK_DEVICE       "/dev/sdf1"
#endif

#define   USBSTICK_MOUNT        "./mount_usbstick"
#define   USBSTICK_UNMOUNT      "./unmount_usbstick"

/*
#define   DEFAULT_PRJS_FOLDER   "~/lms2012/prjs"      //!&lt; Project folder name without trailing "/"
#define   DEFAULT_APPS_FOLDER   "~/lms2012/apps"      //!&lt; Applet folder name without trailing "/"
#define   DEFAULT_TOOLS_FOLDER  "~/lms2012/tools"     //!&lt; Setting folder name without trailing "/"
#define   DEFAULT_SYS_FOLDER    "~/lms2012/sys"       //!&lt; System folder name without trailing "/"
#define   DEFAULT_SETUP_FOLDER  "~/lms2012/sys"       //!&lt; Setup folder name without trailing "/"
#define   DEFAULT_SD_FOLDER     "~/lms2012/SD Card"   //!&lt; Sd card folder name without trailing "/"
#define   DEFAULT_USB_FOLDER    "~/lms2012/USB Memory"//!&lt; USB Memory folder name without trailing "/"
*/

#define   DEFAULT_FOLDER        "ui"                  //!&lt; Folder containing the first small programs
#define   DEFAULT_UI            "ui"                  //!&lt; Default user interface

#define   DEFAULT_VOLUME        vmDEFAULT_VOLUME
#define   DEFAULT_SLEEPMINUTES  vmDEFAULT_SLEEPMINUTES

#define   COM_CMD_DEVICE_NAME   USBDEV_DEVICE_NAME    //!&lt; USB HID command pipe device file name

/*! </pre><pre class="fragment"> */

// HARDWARE

#define   vmOUTPUTS                     4                             //!&lt; Number of output ports in the system
#define   vmINPUTS                      4                             //!&lt; Number of input  ports in the system
#define   vmBUTTONS                     6                             //!&lt; Number of buttons in the system
#define   vmLEDS                        4                             //!&lt; Number of LEDs in the system

#define   vmLCD_WIDTH                   178                           //!&lt; LCD horizontal pixels
#define   vmLCD_HEIGHT                  128                           //!&lt; LCD vertical pixels
#define   vmTOPLINE_HEIGHT              10                            //!&lt; Top line vertical pixels
#define   vmLCD_STORE_LEVELS            3                             //!&lt; Store levels

#define   vmDEFAULT_VOLUME              100
#define   vmDEFAULT_SLEEPMINUTES        30

// SOFTWARE

#define   vmFG_COLOR                    1                             //!&lt;  Forground color
#define   vmBG_COLOR                    0                             //!&lt;  Background color

#define   vmCHAIN_DEPT                  4                             //!&lt; Number of bricks in the USB daisy chain (master + slaves)

#define   FILEPERMISSIONS               (S_IRUSR | S_IWUSR | S_IRGRP | S_IWGRP | S_IROTH | S_IWOTH)
#define   DIRPERMISSIONS                (S_IRWXU | S_IRWXG | S_IRWXO)
#define   SYSPERMISSIONS                (S_IRUSR | S_IWUSR | S_IRGRP | S_IROTH)

#define   vmPATHSIZE                    84                            //!&lt; Max path size excluding trailing forward slash including zero termination
#define   vmNAMESIZE                    32                            //!&lt; Max name size including zero termination (must be divideable by 4)
#define   vmEXTSIZE                     5                             //!&lt; Max extension size including dot and zero termination
#define   vmFILENAMESIZE                120                           //!&lt; Max filename size including path, name, extension and termination (must be divideable by 4)
#define   vmMACSIZE                     18                            //!&lt; Max WIFI MAC size including zero termination
#define   vmIPSIZE                      16                            //!&lt; Max WIFI IP size including zero termination
#define   vmBTADRSIZE                   13                            //!&lt; Max bluetooth address size including zero termination

#define   vmERR_STRING_SIZE             32                            // Inclusive zero termination

#define   vmEVENT_BT_PIN                1
#define   vmEVENT_BT_REQ_CONF           2

#define   vmMAX_VALID_TYPE              101                           //!&lt; Highest valid device type

// FOLDERS

#define   vmMEMORY_FOLDER               "/mnt/ramdisk"                //!&lt; Folder for non volatile user programs/data
#define   vmPROGRAM_FOLDER              "../prjs/BrkProg_SAVE"        //!&lt; Folder for On Brick Programming programs
#define   vmDATALOG_FOLDER              "../prjs/BrkDL_SAVE"          //!&lt; Folder for On Brick Data log files
#define   vmSDCARD_FOLDER               "../prjs/SD_Card"             //!&lt; Folder for SD card mount
#define   vmUSBSTICK_FOLDER             "../prjs/USB_Stick"           //!&lt; Folder for USB stick mount

#define   vmPRJS_DIR                    "../prjs"                     //!&lt; Project folder
#define   vmAPPS_DIR                    "../apps"                     //!&lt; Apps folder
#define   vmTOOLS_DIR                   "../tools"                    //!&lt; Tools folder
#define   vmTMP_DIR                     "../tmp"                      //!&lt; Temporary folder

#define   vmSETTINGS_DIR                "../sys/settings"             //!&lt; Folder for non volatile settings

#define   vmDIR_DEEPT                   127                           //!&lt; Max directory items allocated including "." and ".."

// FILES USED IN APPLICATION

#define   vmLASTRUN_FILE_NAME           "lastrun"                     //!&lt; Last run filename
#define   vmCALDATA_FILE_NAME           "caldata"                     //!&lt; Calibration data filename

// FILES USED IN APPS

#define   vmSLEEP_FILE_NAME             "Sleep"                       //!&lt; File used in "Sleep" app to save status
#define   vmVOLUME_FILE_NAME            "Volume"                      //!&lt; File used in "Volume" app to save status
#define   vmWIFI_FILE_NAME              "WiFi"                        //!&lt; File used in "WiFi" app to save status
#define   vmBLUETOOTH_FILE_NAME         "Bluetooth"                   //!&lt; File used in "Bluetooth" app to save status

// EXTENSIONS

#define   vmEXT_SOUND                   ".rsf"                        //!&lt; Robot Sound File
#define   vmEXT_GRAPHICS                ".rgf"                        //!&lt; Robot Graphics File
#define   vmEXT_BYTECODE                ".rbf"                        //!&lt; Robot Byte code File
#define   vmEXT_TEXT                    ".rtf"                        //!&lt; Robot Text File
#define   vmEXT_DATALOG                 ".rdf"                        //!&lt; Robot Datalog File
#define   vmEXT_PROGRAM                 ".rpf"                        //!&lt; Robot Program File
#define   vmEXT_CONFIG                  ".rcf"                        //!&lt; Robot Configuration File
#define   vmEXT_ARCHIVE                 ".raf"                        //!&lt; Robot Archive File

// NAME LENGTHs

#define   vmBRICKNAMESIZE               120                           //!&lt; Brick name maximal size (including zero termination)
#define   vmBTPASSKEYSIZE               7                             //!&lt; Bluetooth pass key size (including zero termination)
#define   vmWIFIPASSKEYSIZE             33                            //!&lt; WiFi pass key size (including zero termination)

// VALID CHARACTERS

#define   vmCHARSET_NAME                0x01                          //!&lt; Character set allowed in brick name and raw filenames
#define   vmCHARSET_FILENAME            0x02                          //!&lt; Character set allowed in file names
#define   vmCHARSET_BTPASSKEY           0x04                          //!&lt; Character set allowed in bluetooth pass key
#define   vmCHARSET_WIFIPASSKEY         0x08                          //!&lt; Character set allowed in WiFi pass key
#define   vmCHARSET_WIFISSID            0x10                          //!&lt; Character set allowed in WiFi ssid

// NUMBER LIMITS

#define   vmDATA8_MIN                   (-127)                        //!&lt; DATA8  negative limit
#define   vmDATA8_MAX                   (127)                         //!&lt; DATA8  positive limit
#define   vmDATA16_MIN                  (-32767)                      //!&lt; DATA16 negative limit
#define   vmDATA16_MAX                  (32767)                       //!&lt; DATA16 positive limit
#define   vmDATA32_MIN                  (-2147483647)                 //!&lt; DATA32 negative limit
#define   vmDATA32_MAX                  (2147483647)                  //!&lt; DATA32 positive limit
#define   vmDATAF_MIN                   (-2147483647)                 //!&lt; DATAF  negative limit
#define   vmDATAF_MAX                   (2147483647)                  //!&lt; DATAF  positive limit

#define   vmDATA8_NAN                   (0x80)
#define   vmDATA16_NAN                  (0x8000)
#define   vmDATA32_NAN                  (0x80000000)
#define   vmDATAF_NAN                   (0x7FC00000)

/* </pre> </div></div><!-- contents -->
<hr size="1"/><address style="text-align: center;">
LEGO&reg Robotics Firmware Documentation<br/>Confidential Information &copy 2013 The LEGO Group</address>
</body>
</html>
